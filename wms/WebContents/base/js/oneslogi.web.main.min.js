/*
* ONEsLOGI Base Web Contents Ver 4.1.30
*/


/*
* このソースは基盤ソースです。変更は行わないで下さい。
*/


FROM_TO_MESSAGE_CD="inputLimitCheckReversalError",dependsModules.push("oneslogiWeb.base"),dependsModules.push("oneslogiWeb.base.liteLogin.PasswordChange"),dependsModules.push("oneslogiWeb.base.common.UserAutoPrintSettingEdit"),dependsModules.push("oneslogiWeb.base.common.UserAutoPrintSettingList"),dependsModules.push("oneslogiWeb.base.common.TerminalSetting"),dependsModules.push("oneslogiWebMain.Utils"),dependsModules.push("oneslogiWeb.PrintRequestParam"),dependsModules.push("oneslogiWeb.ReportLayoutUpload"),dependsModules.push("oneslogiWeb.GridColExt"),dependsModules.push("oneslogiWeb.BaseMaster"),dependsModules.push("oneslogiWeb.Operation"),dependsModules.push("oneslogiWeb.base.common.accordion"),angular.module("oneslogiWeb.Main",dependsModules.get()).config(["$httpProvider","$routeProvider",function(a,b){b.when("/:system/:subSystem/:screenCd",{templateUrl:function(a){return a.system+"/partials/"+a.subSystem+"/"+a.screenCd+".html"},resolve:{getData:["$route","$q","$rootScope","owsSession","owsSystem","owsCulture","owsTerminal","owsMessage","owsMenu","owsScreen","owsItem","owsColumn","userInfo","statusInfo","routeExtend","injectUtil",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){return d.setData().then(function(){return b.all([e.getData(),f.getData(),g.getData()])}).then(function(){return h.getData()}).then(function(){return i.getData()}).then(function(){return b.all([j.getData(a.current.params.screenCd),k.getData(a.current.params.screenCd),l.getData(a.current.params.screenCd)])}).then(function(){if(n.clear(),!o.processStatus.init)return m.userCd=e.getUserCd(),m.userNm=e.getUserNm(),o.doAdditionalFirstRouteChangeProcess(b,c,e,f,h,i,j,k,l,m,n,o.processStatus,p).then(function(){m.init=!0,o.processStatus.init=!0})}).then(function(){return o.doAdditionalEveryRouteChangeProcess(b,c,e,f,h,i,j,k,l,m,n,o.processStatus,p)})}]}}).otherwise({redirectTo:commonRedirectUrl}),a.interceptors.push(["$q","$log","$rootScope","httpExtend",function(b,c,d,e){return{request:function(b){var f=d.duplicateCheckToken;return f?a.defaults.headers.common.duplicateCheckToken=f:delete a.defaults.headers.common.duplicateCheckToken,e.doAdditionalRequestProcess(c,d,b),b},responseError:function(a){return d.isTokenInvalid?b.reject(a):(c.error(a),d.$broadcast("showCommExceptionMessage",a),b.reject(a))},response:function(a){if(d.isTokenInvalid)return b.reject(a);if(a.headers("duplicateCheckToken")&&(d.duplicateCheckToken=a.headers("duplicateCheckToken")),a.data&&a.data.status){if(a.data.status.statusCode<0)return a.data.status.statusCode==-102?(d.isTokenInvalid=!0,d.$broadcast("showTokenInvalidExceptionMessage",a),b.reject(a)):(c.warn(a),d.$broadcast("showBaseExceptionMessage",a),b.reject(a));e.doAdditionalResponseProcess(c,d,a)}return a||b.when(a)}}}])}]).factory("modalFactory",["$modal","alertMessage","$timeout",function(a,b,c){return{modalScreenList:function(c){var d=document.activeElement,e=a.open({templateUrl:"base/partials/master/ScreenListMasterCopy.html",controller:"ScreenListMasterCopy",backdrop:"static",resolve:{getScreen:["owsScreen",function(a){return new a.getData("ScreenListMasterCopy",!0)}],getItem:["owsItem",function(a){return new a.getData("ScreenListMasterCopy")}],getColumn:["owsColumn",function(a){return new a.getData("ScreenListMasterCopy")}],items:function(){return c}},windowClass:"app-modal-window",beforeClose:function(){b.removeModalAlert("ScreenListMasterCopy"),d.focus(),getNextObject(d,!0).focus()},beforeDismiss:function(){b.removeModalAlert("ScreenListMasterCopy"),d.focus(),getNextObject(d,!0).focus()}});return e.opened.then(function(){b.addModalAlert(e,"ScreenListMasterCopy")}),e},modalRoleList:function(c){var d=document.activeElement,e=a.open({templateUrl:"base/partials/master/RoleListCopy.html",controller:"RoleListCopy",backdrop:"static",resolve:{getScreen:["owsScreen",function(a){return new a.getData("RoleListCopy",!0)}],getItem:["owsItem",function(a){return new a.getData("RoleListCopy")}],getColumn:["owsColumn",function(a){return new a.getData("RoleListCopy")}],items:function(){return c}},windowClass:"app-modal-window",beforeClose:function(){b.removeModalAlert("RoleListCopy"),d.focus(),getNextObject(d,!0).focus()},beforeDismiss:function(){b.removeModalAlert("RoleListCopy"),d.focus(),getNextObject(d,!0).focus()}});return e.opened.then(function(){b.addModalAlert(e,"RoleListCopy")}),e}}}]).factory("statusInfo",["$filter","optionMessageControl","gridOptionMessageControl","alertMessage","directiveControl","owsCommon","gridDirectiveControl",function(a,b,c,d,e,f,g){var h=[];return{clear:function(){h=[]},mappingErrorMessage:function(a,b,c,d){var e={};e.type=1,e.statusCd=c,"undefined"==typeof d?e.subStatusCd=0:e.subStatusCd=d,e.scope=a,e.controlId=b,h.push(e)},mappingGridErrorMessage:function(a,b,c,d){var e={};e.type=2,e.statusCd=c,"undefined"==typeof d?e.subStatusCd=0:e.subStatusCd=d,e.gridOptions=a,e.columnCd=b,h.push(e)},isSuccess:function(a){if(null==a.status.listStatus||0==a.status.listStatus.length)return!0;for(var b=0;b<a.status.listStatus.length;b++)if(!(a.status.listStatus[b].status.statusCode<2)&&2!=a.status.listStatus[b].status.statusType)return!1;return!0},isSuccessAndShowMessage:function(i,j){if(null==i.status.listStatus||0==i.status.listStatus.length)return!0;for(var k=!1,l=!1,m=!1,n=null,o=-1,p=!1,q=[],r=0;r<i.status.listStatus.length;r++){(i.status.listStatus[r].status.statusCode>1&&0==i.status.listStatus[r].status.subStatusCode||i.status.listStatus[r].status.statusCode>1&&i.status.listStatus[r].status.subStatusCode>1)&&(k=!0);var s;switch(s=0==i.status.listStatus[r].status.subStatusCode?i.status.listStatus[r].status.statusCode:i.status.listStatus[r].status.subStatusCode){case 0:continue;case 1:continue;default:for(var t,u=!1,v=-1,w=0;w<h.length;w++)t=h[w],i.status.listStatus[r].status.statusCode==t.statusCd&&i.status.listStatus[r].status.subStatusCode==t.subStatusCd&&(1==t.type?(b.isShow(t.scope,t.controlId)||b.show(t.scope,t.controlId,a("owfMessage")(i.status.listStatus[r].status.messageCode,i.status.listStatus[r].status.messageReplaceValue)),p=!0):2==t.type&&(c.isShow(t.gridOptions,t.columnCd,i.status.listStatus[r].status.rowIndex)||(c.show(t.gridOptions,t.columnCd,a("owfMessage")(i.status.listStatus[r].status.messageCode,i.status.listStatus[r].status.messageReplaceValue),i.status.listStatus[r].status.rowIndex),(v=-1)&&(v=i.status.listStatus[r].status.rowIndex)),n||(n=t,o=i.status.listStatus[r].status.rowIndex)),u=!0);!u&&i.status.listStatus[r].status.statusCode>0&&(2==i.status.listStatus[r].status.statusType?(m=!0,q.push(i.status.listStatus[r].status)):(l=!0,d.setErrorMessageByCode(i.status.listStatus[r].status.messageCode,i.status.listStatus[r].status.messageReplaceValue)))}}if(k&&(l||!m&&!l))return!p&&n&&g.scrollingByRowIndex(n.gridOptions,o),e.firstErrorOnFocus(j),!1;for(var r=0;r<q.length;r++)d.setWarningMessageByCode(q[r].messageCode,q[r].messageReplaceValue);if(m)return!0;for(var x=!1,r=0;r<i.status.listStatus.length;r++){var s;if(s=0==i.status.listStatus[r].status.subStatusCode?i.status.listStatus[r].status.statusCode:i.status.listStatus[r].status.subStatusCode,1==s){var y=i.status.listStatus[r].status.messageCode;null!=y&&""!=y||(y=i.status.messageCode);var z=f.viewConfirm(y,i.status.listStatus[r].status.messageReplaceValue);if(!z){x=!0;break}}}if(x)return!1;for(var r=0;r<i.status.listStatus.length;r++)0==i.status.listStatus[r].status.statusCode&&null!=i.status.listStatus[r].status.messageCode&&""!=i.status.listStatus[r].status.messageCode&&d.setInfoMessageByCode(i.status.listStatus[r].status.messageCode,i.status.listStatus[r].status.messageReplaceValue);return!0}}}]).provider("userInfo",function(){var a,b,c=!1,d={init:c,userCd:a,userNm:b};this.extend=function(a){d=angular.extend(d,a)},this.$get=function(){return d}}).factory("printFactory",["$modal","alertMessage","$timeout",function(a,b,c){return{modalPrint:function(c){var d=document.activeElement,e=a.open({templateUrl:"base/partials/common/PrintRequestParam.html",backdrop:"static",controller:"PrintRequestParam",resolve:{getScreen:["owsScreen",function(a){return new a.getData("PrintRequestParam",!0)}],getItem:["owsItem",function(a){return new a.getData("PrintRequestParam")}],printParam:function(){return c}},windowClass:"app-modal-window-small",beforeClose:function(){b.removeModalAlert("PrintRequestParam"),d&&d.focus()},beforeDismiss:function(){b.removeModalAlert("PrintRequestParam"),d&&d.focus()}});return e.opened.then(function(){b.addModalAlert(e,"PrintRequestParam")}),e},modalRePrint:function(c){var d=document.activeElement,e=a.open({templateUrl:"base/partials/common/PrintRequestParam.html",backdrop:"static",controller:"RePrintRequestParam",resolve:{getScreen:["owsScreen",function(a){return new a.getData("PrintRequestParam",!0)}],getItem:["owsItem",function(a){return new a.getData("PrintRequestParam")}],printRequest:function(){return c}},windowClass:"app-modal-window-small",beforeClose:function(){b.removeModalAlert("PrintRequestParam"),d.focus()},beforeDismiss:function(){b.removeModalAlert("PrintRequestParam"),d.focus()}});return e.opened.then(function(){b.addModalAlert(e,"PrintRequestParam")}),e},outputType:{html:1,pdf:2,print:3}}}]).controller("AlertCtrl",["$scope","$rootScope","$filter","$log","alertMessage","owsCommon","$window","$location","alertCtrlExtend",function(a,b,c,d,e,f,g,h,i){a.isViewAlert=!1,a.viewAlertToggle=function(){a.isViewAlert=!a.isViewAlert},a.closeAlert=function(a,c){if(c)b.alerts=[];else for(var d=0;d<b.alerts.length;d++)if(b.alerts[d].id==a){b.alerts.splice(d,1);break}},b.initAlertCtrl||(b.initAlertCtrl=!0,b.$on("showCommExceptionMessage",function(a,b){var d=c("owfMessage"),f=d("httpConnectionError",[b.status,b.config.url],!1);e.setErrorMessage(f)}),b.$on("showBaseExceptionMessage",function(a,b){var d=c("owfMessage"),f=d(b.data.status.messageCode,b.data.status.messageReplaceValue,!1);e.setErrorMessage(f)}),b.$on("showTokenInvalidExceptionMessage",function(a,b){var d=c("owfMessage"),e=d(b.data.status.messageCode,b.data.status.messageReplaceValue,!1);if(null!=e&&""!=e&&f.viewAlert(e),null!=b.data.status.moreValue&&""!=b.data.status.moreValue){var g=b.data.status.moreValue.lastIndexOf("?");g!=-1&&b.data.status.moreValue.indexOf("=",g+1)!=-1?location.href=b.data.status.moreValue+"&goto="+encodeURIComponent(location.href):location.href=b.data.status.moreValue+"?goto="+encodeURIComponent(location.href)}}),b.$on("isMismatchBColAndExtMessage",function(a,b){var d=c("owfMessage"),f=d("isMismatchBColAndExtWarn","",!1);e.setWarningMessage(f)}),b.$on("accessDisableToScreenMessage",function(a,b){f.viewAlert("accessDisableToScreenError"),g.location.hash=commonRedirectUrl,g.location.reload()}),i.doAdditionalInitProcess(b,c,d,e,f,g,h))}]).controller("OneslogiWebMainCtrl",["$scope","$route","$filter","$location","$q","$window","$timeout","owsCommon","userInfo","PasswordChangeDialog","UserAutoPrintSettingListDialog","TerminalSettingDialog","VIEW_MODE_PASSWORD_CHANGE",function(a,b,c,d,e,f,g,h,i,j,k,l,m){a.navbar={},a.navbar.isCollapsed=!0,a.userInfo=i,a.showPasswordChangeDialog=function(){document.activeElement.blur(),j.show(i.userCd,commonRedirectUrl,m,a.$parent.culture.bCulture.cultureCd)},a.showUserAutoPrintSettingListDialog=function(){document.activeElement.blur();var a={mode:0,userCd:i.userCd};k.show(a)},a.showTerminalAutoPrintSettingListDialog=function(){document.activeElement.blur();var a={mode:1};k.show(a)},a.showTerminalSettingDialog=function(){document.activeElement.blur();var a={};l.show(a)};var n=!1,o=!1,p=!1,q=-1,r=-1,s=-1,t=-1,u=[],v=function(a){var b,c;return a.currentStyle?(b=a.currentStyle,c=b.display):window.getComputedStyle&&(b=window.getComputedStyle(a,null),c=b.getPropertyValue("display")),"none"!=c},w=function(a){for(var b=0,c=0;c<u.length;c++){var d=(u[c].ngGridName,u[c].gridTagId),e="#"+d,f=$(e),g=v(f[0]);u[c].display=g,g&&b++}return b},x=function(){if(!($("#contents").length<1)&&($("#navbar").length>0&&$("body").css("padding-top",$("#navbar")[0].offsetHeight-20),n||o||p||gridAdjustFlg)){var b=$(window).height(),c=$("#contents")[0].offsetTop,d=$("#contents")[0].offsetHeight,e=20;if(n){if(s==-1){var f,g=document.styleSheets;a:for(var h=0;h<g.length;h++){f=g[h].cssRules;for(var i=0;i<f.length;i++)if(f[i].cssText.indexOf("#content-footer-button")!=-1){var j=f[i].style.height;j=j.replace("px",""),s=parseFloat(j);break a}}s==-1&&(s=75)}$("#wrap").css("margin-bottom",s*-1),$("#wrap").css("padding-bottom",s),b<c+d+s?(e=r+s,$("#content-footer").css("height",e),$("#content-footer-button").css("height",s)):(e=s,$("#content-footer").css("height",e),$("#content-footer-button").css("height",b-(c+d)))}else if(o){if(t==-1){var f,g=document.styleSheets;a:for(var h=0;h<g.length;h++){f=g[h].cssRules;for(var i=0;i<f.length;i++)if(f[i].cssText.indexOf("#content-footer-control")!=-1){var j=f[i].style.height;j=j.replace("px",""),t=parseFloat(j);break a}}t==-1&&(t=105)}$("#wrap").css("margin-bottom",t*-1),$("#wrap").css("padding-bottom",t),b<c+d+t?(e=r+t,$("#content-footer").css("height",e),$("#content-footer-control").css("height",t)):(e=t,$("#content-footer").css("height",e),$("#content-footer-control").css("height",b-(c+d)))}if(gridAdjustFlg){var k=w(u);if(k>1)return;for(var h=0;h<u.length;h++){var l=(u[h].ngGridName,u[h].gridTagId),m="#"+l,q=$(m);if(u[h].display&&p&&!a.$parent.$root.modalView){var v=q[0].offsetTop,x=b-v-e-25;x>280&&angular.element(m).css("height",x+"px")}}}}},y=function(){g(function(){x()},10)},z=!1,A=[-1,-1,-1,-1,-1];a.$root.$on("$viewContentLoaded",function(){if(q==-1){var b,c=document.styleSheets;a:for(var d=0;d<c.length;d++){b=c[d].cssRules;for(var e=0;e<b.length;e++)if(b[e].cssText.indexOf("#footer")!=-1){var h=b[e].style.height;h=h.replace("px",""),q=parseFloat(h);break a}}q==-1&&(q=20)}if(r==-1){var b,c=document.styleSheets;a:for(var d=0;d<c.length;d++){b=c[d].cssRules;for(var e=0;e<b.length;e++)if(b[e].cssText.indexOf("#content-footer")!=-1){var h=b[e].style.height;h=h.replace("px",""),r=parseFloat(h);break a}}r==-1&&(r=15)}u=[];for(var i=$("*"),d=0;d<i.length;d++)if(i[d].getAttribute("ui-grid")){var j=i[d].getAttribute("ui-grid"),k=i[d].id,l=!0;a.$$childTail.$$childTail[j]&&("undefined"!=typeof a.$$childTail.$$childTail[j].initialVisibility&&(l=a.$$childTail.$$childTail[j].initialVisibility),u.push({ngGridName:j,gridTagId:k}))}return angular.element(f).unbind("resize",x),void 0==$("#wrap")||null==$("#wrap")||$("#wrap").length<1?(n=!1,void(o=!1)):($("#wrap").css("margin-bottom",q*-1),$("#wrap").css("padding-bottom",q),(void 0==$("#content-footer")||null==$("#content-footer")||$("#content-footer").length<1)&&(n=!1,o=!1),(void 0==$("#content-footer-button")||null==$("#content-footer-button")||$("#content-footer-button").length<1)&&(void 0==$("#content-footer-control")||null==$("#content-footer-control")||$("#content-footer-control").length<1)&&(n=!1,o=!1),void 0!=$("#content-footer-button")&&null!=$("#content-footer-button")&&$("#content-footer-button").length>0?(n=!0,o=!1,$("#content-footer-button").hide()):void 0!=$("#content-footer-control")&&null!=$("#content-footer-control")&&$("#content-footer-control").length>0&&(n=!1,o=!0,$("#content-footer-control").hide()),p=!!(u&&u.length&&u.length>0),void g(function(){x(),n?$("#content-footer-button").show():o&&$("#content-footer-control").show(),angular.element(f).bind("resize",x),z||(z=!0,a.$root.$watchCollection(function(){return $("#contents").length<1?A:(A[0]=$("#contents")[0].offsetTop,A[1]=$("#contents")[0].offsetLeft,A[2]=$("#contents")[0].offsetHeight,A[3]=$("#contents")[0].offsetWidth,$("#navbar").length>0&&(A[4]=$("#navbar")[0].offsetHeight),A)},y))},100))})}]).provider("alertCtrlExtend",function(){this.additionalInitProcess=null,this.setAdditionalInitProcess=function(a){if(null==a)this.additionalInitProcess=null;else{if("function"!=typeof a)throw this.additionalInitProcess=null,new Error("[oneslogiWebMain]alertCtrlExtend#setAdditionalInitProcess requires a function.");this.additionalInitProcess=a}},this.$get=function(){var a=this.additionalInitProcess;return{doAdditionalInitProcess:function(b,c,d,e,f,g,h){null!=a&&a(b,c,d,e,f,g,h)}}}}).provider("httpExtend",function(){this.additionalRequestProcess=null,this.setAdditionalRequestProcess=function(a){if(null==a)this.additionalRequestProcess=null;else{if("function"!=typeof a)throw this.additionalRequestProcess=null,new Error("[oneslogiWebMain]httpExtend#setAdditionalRequestProcess requires a function.");this.additionalRequestProcess=a}},this.additionalResponseProcess=null,this.setAdditionalResponseProcess=function(a){if(null==a)this.additionalResponseProcess=null;else{if("function"!=typeof a)throw this.additionalResponseProcess=null,new Error("[oneslogiWebMain]httpExtend#setAdditionalResponseProcess requires a function.");this.additionalResponseProcess=a}},this.$get=function(){var a=this.additionalRequestProcess,b=this.additionalResponseProcess;return{doAdditionalRequestProcess:function(b,c,d){null!=a&&a(b,c,d)},doAdditionalResponseProcess:function(a,c,d){null!=b&&b(a,c,d)}}}}).provider("routeExtend",function(){this.processStatus={init:!1},this.additionalFirstRouteChangeProcess=null,this.setAdditionalFirstRouteChangeProcess=function(a){if(null==a)this.additionalFirstRouteChangeProcess=null;else{if("function"!=typeof a)throw this.additionalFirstRouteChangeProcess=null,new Error("[oneslogiWebMain]routeExtend#setAdditionalFirstRouteChangeProcess requires a function.");this.additionalFirstRouteChangeProcess=a}},this.additionalEveryRouteChangeProcess=null,this.setAdditionalEveryRouteChangeProcess=function(a){if(null==a)this.additionalEveryRouteChangeProcess=null;else{if("function"!=typeof a)throw this.additionalEveryRouteChangeProcess=null,new Error("[oneslogiWebMain]routeExtend#setAdditionalEveryRouteChangeProcess requires a function.");this.additionalEveryRouteChangeProcess=a}},this.extend=function(a){this.processStatus=angular.extend(this.processStatus,a)},this.$get=function(){var a=this.additionalFirstRouteChangeProcess,b=this.additionalEveryRouteChangeProcess,c=this.processStatus;return{processStatus:c,doAdditionalFirstRouteChangeProcess:function(b,c,d,e,f,g,h,i,j,k,l,m,n){if(null!=a)return a(b,c,d,e,f,g,h,i,j,k,l,m,n);var o=b.defer();return o.resolve(),o.promise},doAdditionalEveryRouteChangeProcess:function(a,c,d,e,f,g,h,i,j,k,l,m,n){if(null!=b)return b(a,c,d,e,f,g,h,i,j,k,l,m,n);var o=a.defer();return o.resolve(),o.promise}}}}),angular.module("oneslogiWebMain.Utils",[]).service("injectUtil",function(){this.get=function(a,b){if(!a)throw new Error("[oneslogiWebMain.Utils]injectUtil#get requires moduleName.");if(!b)throw new Error("[oneslogiWebMain.Utils]injectUtil#get requires serviceName.");var c=angular.injector([a]);if(c.has(b))return c.get(b);throw new Error("[oneslogiWebMain.Utils]injectUtil#get could not find the service "+b+".")}});